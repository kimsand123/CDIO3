<!-- User selection -->

<select class="custom-select" id="userList">
	<option value="0" selected>VÃ¦lg en bruger fra listen</option>
</select>

<!-- // User selection -->

<!-- User edit form -->

<div id="editUser"></div>

<!-- // User edit form -->

<!-- JS -->

<script>
	$(function() {

		var url = "rest/user/list";
		$
				.getJSON(url)

				.done(
						function(data) {

							var list = $("#userList");
							var edit = $("#editUser");

							var i = 1;

							data
									.forEach(function(user) {

										//Cast to string for checking later
										var str = String(user.roles);

										$(list)
												.append(
														'<option value="' + i + '">'
																+ user.id
																+ '</option>');

										var s = "<div id='"+user.id+"' class='loader' style='display: none;'>";
										s += "<form id='' class'' >";
										//var s = "<form id='user-edit-form' class'"+user.id+"'>";
										s += "<div class='form-group'>";
										s += "<label for='brugerID'>Id:</label><input type='text' class='form-control' id='brugerID' placeholder='Indtast et bruger id' value='" + user.id + "'>";
										s += "</div>";

										s += "<div class='form-group'>";
										s += "<label for='ini'>Brugernavn</label> <input type='text' class='form-control' id='brugernavn' placeholder='Indtast et brugernavn' value='" + user.username + "'>";
										s += "</div>";

										s += "<div class='form-group'>";
										s += "<label for='ini'>INI</label> <input type='text' class='form-control' id='ini' placeholder='Indtast et ini' value='" + user.ini + "'>";
										s += "</div>";

										s += "<div class='form-group'>";
										s += "<label for='ini'>CPR</label> <input type='text' class='form-control' id='cpr' placeholder='Indtast et cpr nr.' value='" + user.cpr + "'>";
										s += "</div>";

										s += "<div class='form-group'>";
										s += "<label for='roles'>Roller:</label>";
										s += "<br> ";

										// Checking for roles

										if (str.search("Admin") != -1) {
											s += "<input id='adminTick' type='checkbox' checked='checked' name='' value='1' /> Administrator";
										} else {
											s += "<input id='adminTick' type='checkbox' name='' value='1' /> Administrator";
										}
										s += "<br>";
										if (str.search("Foreman") != -1) {
											s += "<input id='foremanTick' type='checkbox' checked='checked' name='' value='1' /> Foreman";
										} else {
											s += "<input id='foremanTick' type='checkbox' name='' value='1' /> Foreman";
										}
										s += "<br>";
										if (str.search("Operator") != -1) {
											s += "<input id='operatorTick' type='checkbox' checked='checked' name='' value='1' /> Operator";
										} else {
											s += "<input id='operatorTick' type='checkbox' name='' value='1' /> Operator";
										}
										s += "<br>";
										if (str.search("Pharmacist") != -1) {
											s += "<input id='pharmacistTick' type='checkbox' checked='checked' name='' value='1' /> Pharmacist";
										} else {
											s += "<input id='pharmacistTick' type='checkbox' name='' value='1' /> Pharmacist";
										}

										s += "</div>";
										s += "</form>";

										s += "<button type='submit' class='btn btn-primary' id='"+user.id+"'>Gem data</button>";
										s += "</div>";

										$(edit).append(s);

										i++;

									});

							$("#userList").on('change', function() {
								//alert( this.value );
								$('.loader').hide();
								var edit = "#" + this.value;
								$(edit).show();
							});
							
							/* Update choosen user */
							
							$(".btn-primary").click(function submit() {	
								var userID = this.id;
								var url = "rest/user/update/"+ userID;
								//alert(url);
								$.ajax({
								    url,
								    type: 'PUT',
								    success: function(result) {
								       alert("User: "+ userID +" updated");
								    }
								});
							});

						});

	});
</script>
